import type { QualityReport, QualityCheck } from "@/types/platform";

// ===== HELPER: Metric ID references (aligned with metrics.ts canonical IDs) =====
const M = {
  TOTAL_REVENUE: "metric-total-revenue",
  TUITION_REVENUE: "metric-tuition-revenue",
  RESEARCH_EXPENDITURE: "metric-research-expenditure",
  ENDOWMENT: "metric-endowment",
  ENROLLMENT_TOTAL: "metric-total-enrollment",
  ENROLLMENT_UG: "metric-undergrad-enrollment",
  ENROLLMENT_GRAD: "metric-grad-enrollment",
  RETENTION_RATE: "metric-retention-rate",
  GRAD_RATE_6YR: "metric-6yr-grad-rate",
  GRAD_RATE_4YR: "metric-4yr-grad-rate",
  FACULTY_COUNT: "metric-faculty-count",
  SF_RATIO: "metric-student-faculty-ratio",
  DEFERRED_MAINTENANCE: "metric-deferred-maintenance",
  AUXILIARY_MARGIN: "metric-auxiliary-margin",
};

const MN = {
  [M.TOTAL_REVENUE]: "Total Operating Revenue",
  [M.TUITION_REVENUE]: "Net Tuition Revenue",
  [M.RESEARCH_EXPENDITURE]: "Research Expenditures",
  [M.ENDOWMENT]: "Endowment Market Value",
  [M.ENROLLMENT_TOTAL]: "Total Fall Enrollment",
  [M.ENROLLMENT_UG]: "Undergraduate Enrollment",
  [M.ENROLLMENT_GRAD]: "Graduate Enrollment",
  [M.RETENTION_RATE]: "First-Year Retention Rate",
  [M.GRAD_RATE_6YR]: "Six-Year Graduation Rate",
  [M.GRAD_RATE_4YR]: "Four-Year Graduation Rate",
  [M.FACULTY_COUNT]: "Full-Time Faculty",
  [M.SF_RATIO]: "Student-to-Faculty Ratio",
  [M.DEFERRED_MAINTENANCE]: "Deferred Maintenance Backlog",
  [M.AUXILIARY_MARGIN]: "Auxiliary Services Margin",
};

// ===== REPORT 1: SUNY Buffalo 2024 — Score 92, 16 pass / 1 fail / 2 warning / 1 skipped =====

const checksQR001: QualityCheck[] = [
  // --- structural (5) ---
  {
    id: "qc-001-01",
    check_type: "structural",
    check_name: "Value Type Check",
    description: "Ensures each metric value matches its expected data type (numeric, percentage, currency, etc.)",
    severity: "info",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "All 14 submitted metric values match their declared data types. Revenue and endowment values are numeric currency; percentages fall within 0-100; counts are non-negative integers.",
    run_at: "2024-08-15T09:00:00Z",
  },
  {
    id: "qc-001-02",
    check_type: "structural",
    check_name: "Completeness Check",
    description: "Ensures all required dimensions (fiscal year, entity, peer group) are present for each observation",
    severity: "warning",
    target_metric_id: M.DEFERRED_MAINTENANCE,
    target_metric_name: MN[M.DEFERRED_MAINTENANCE],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "warning",
    result_detail: "Deferred Maintenance Backlog is missing the 'building_category' dimension breakdown. The aggregate value is present but granular facility-level data was not provided. Consider requesting a facilities condition assessment update.",
    expected_value: "Aggregate + building_category breakdown",
    actual_value: "Aggregate only",
    run_at: "2024-08-15T09:00:00Z",
  },
  {
    id: "qc-001-03",
    check_type: "structural",
    check_name: "Unit Consistency",
    description: "Ensures the unit of each observation matches the metric definition's declared unit",
    severity: "info",
    target_metric_id: M.ENDOWMENT,
    target_metric_name: MN[M.ENDOWMENT],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Endowment Market Value reported in USD (currency) which matches the metric definition. All currency values are consistently reported in nominal USD.",
    run_at: "2024-08-15T09:00:00Z",
  },
  {
    id: "qc-001-04",
    check_type: "structural",
    check_name: "Null Value Check",
    description: "Checks for missing or null values in required metric fields",
    severity: "critical",
    target_metric_id: M.AUXILIARY_MARGIN,
    target_metric_name: MN[M.AUXILIARY_MARGIN],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "No null or missing values detected across all 14 required metrics for SUNY Buffalo FY2024. Every metric observation has a non-null value, source document reference, and timestamp.",
    run_at: "2024-08-15T09:00:00Z",
  },
  {
    id: "qc-001-05",
    check_type: "structural",
    check_name: "Format Validation",
    description: "Checks that numeric values conform to expected format (decimal places, thousands separators stripped)",
    severity: "info",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Total Fall Enrollment value of 32,347 correctly parsed as integer count. All currency values stored as whole dollars without cents. Percentages stored with up to 1 decimal place.",
    run_at: "2024-08-15T09:00:00Z",
  },
  // --- semantic (5) ---
  {
    id: "qc-001-06",
    check_type: "semantic",
    check_name: "Range Plausibility",
    description: "Checks if the metric value falls within a plausible range for this institution type and size",
    severity: "info",
    target_metric_id: M.RETENTION_RATE,
    target_metric_name: MN[M.RETENTION_RATE],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "First-Year Retention Rate of 87.2% is within the expected range for AAU public research universities (80%-96%). The value is consistent with SUNY Buffalo's historical range of 85%-89%.",
    run_at: "2024-08-15T09:00:00Z",
  },
  {
    id: "qc-001-07",
    check_type: "semantic",
    check_name: "Business Rule: Revenue > Tuition",
    description: "Validates that total operating revenue exceeds net tuition revenue (a logical necessity)",
    severity: "critical",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Total Operating Revenue ($1.82B) exceeds Net Tuition Revenue ($412M) as expected. Tuition represents approximately 22.6% of total revenue, which is consistent with a state-funded research university.",
    run_at: "2024-08-15T09:00:00Z",
  },
  {
    id: "qc-001-08",
    check_type: "semantic",
    check_name: "Percentage Bound",
    description: "Ensures percentage-type metrics fall within 0-100 range",
    severity: "critical",
    target_metric_id: M.GRAD_RATE_6YR,
    target_metric_name: MN[M.GRAD_RATE_6YR],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Six-Year Graduation Rate of 75.8% is within the valid 0-100 range. All four percentage-type metrics (retention rate, 4-year grad rate, 6-year grad rate, auxiliary margin) are within bounds.",
    run_at: "2024-08-15T09:00:00Z",
  },
  {
    id: "qc-001-09",
    check_type: "semantic",
    check_name: "Non-Negative Value",
    description: "Ensures count and currency metrics are non-negative",
    severity: "warning",
    target_metric_id: M.RESEARCH_EXPENDITURE,
    target_metric_name: MN[M.RESEARCH_EXPENDITURE],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Research Expenditures of $548M is a positive value. All count-type (enrollment, faculty) and currency-type (revenue, endowment, research) metrics are non-negative.",
    run_at: "2024-08-15T09:00:00Z",
  },
  {
    id: "qc-001-10",
    check_type: "semantic",
    check_name: "Ratio Reasonableness",
    description: "Checks that student-to-faculty ratio falls within a reasonable range of 5:1 to 30:1",
    severity: "warning",
    target_metric_id: M.SF_RATIO,
    target_metric_name: MN[M.SF_RATIO],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Student-to-Faculty Ratio of 14.2:1 falls within the acceptable range of 5:1 to 30:1. This is typical for a large public research university and aligns with peer institution averages (13:1 to 18:1).",
    run_at: "2024-08-15T09:00:00Z",
  },
  // --- temporal (4) ---
  {
    id: "qc-001-11",
    check_type: "temporal",
    check_name: "Year-Over-Year Change",
    description: "Flags any metric with greater than 50% year-over-year change as potentially erroneous",
    severity: "warning",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "warning",
    result_detail: "Total Operating Revenue changed by +8.3% from FY2023 ($1.68B) to FY2024 ($1.82B). While within the 50% threshold, this exceeds the 5-year average annual growth of 4.1%. The increase may be attributable to a new state funding allocation. Flagging for informational review.",
    expected_value: "Change within +/- 50%",
    actual_value: "+8.3% year-over-year",
    run_at: "2024-08-15T09:00:00Z",
  },
  {
    id: "qc-001-12",
    check_type: "temporal",
    check_name: "Trend Consistency",
    description: "Checks if the current value is consistent with the 5-year trend line for this metric",
    severity: "critical",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Total Fall Enrollment of 32,347 is consistent with the 5-year upward trend (31,503 -> 31,789 -> 31,923 -> 32,105 -> 32,347). The annualized growth rate of 0.7% is within the expected trend corridor of -2% to +3%.",
    run_at: "2024-08-15T09:00:00Z",
  },
  {
    id: "qc-001-13",
    check_type: "temporal",
    check_name: "Missing Year Check",
    description: "Verifies there are no gaps in the annual series for each metric",
    severity: "critical",
    target_metric_id: M.ENDOWMENT,
    target_metric_name: MN[M.ENDOWMENT],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "fail",
    result_detail: "Endowment Market Value is missing data for FY2020. The series has values for FY2015-FY2019 and FY2021-FY2024, creating a one-year gap. This may be due to delayed reporting during the COVID-19 pandemic. Recommend sourcing the FY2020 value from the NACUBO endowment study.",
    expected_value: "Continuous annual series FY2015-FY2024",
    actual_value: "Gap in FY2020",
    run_at: "2024-08-15T09:00:00Z",
  },
  {
    id: "qc-001-14",
    check_type: "temporal",
    check_name: "Monotonic Check",
    description: "Checks that endowment values do not drop more than 30% year-over-year (market correction threshold)",
    severity: "critical",
    target_metric_id: M.ENDOWMENT,
    target_metric_name: MN[M.ENDOWMENT],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Endowment Market Value changes between consecutive years are all within the -30% threshold. Largest single-year decline was -12.4% in FY2022, consistent with the broad market downturn. FY2024 value of $1.14B represents a recovery to pre-downturn levels.",
    run_at: "2024-08-15T09:00:00Z",
  },
  // --- cross_source (3) ---
  {
    id: "qc-001-15",
    check_type: "cross_source",
    check_name: "IPEDS vs Internal Match",
    description: "Compares enrollment figures from IPEDS with internally reported enrollment data",
    severity: "critical",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "IPEDS-reported Total Fall Enrollment (32,347) matches the internal institutional research report (32,341) within a 0.02% tolerance. The 6-student difference is attributable to late-add registrations captured in the internal system but not in the IPEDS snapshot date.",
    run_at: "2024-08-15T09:00:00Z",
  },
  {
    id: "qc-001-16",
    check_type: "cross_source",
    check_name: "CDS vs IPEDS Enrollment",
    description: "Cross-references Common Data Set enrollment figures against IPEDS for consistency",
    severity: "warning",
    target_metric_id: M.ENROLLMENT_UG,
    target_metric_name: MN[M.ENROLLMENT_UG],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Common Data Set undergraduate enrollment (21,607) matches IPEDS undergraduate headcount (21,607) exactly. Graduate enrollment from CDS (10,740) also aligns with IPEDS (10,740). Cross-source consistency confirmed.",
    run_at: "2024-08-15T09:00:00Z",
  },
  {
    id: "qc-001-17",
    check_type: "cross_source",
    check_name: "Multi-Source Revenue",
    description: "Checks that revenue figures are consistent across audited financials, IPEDS Finance, and internal reports",
    severity: "critical",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Total Operating Revenue from audited financial statements ($1.82B) aligns with IPEDS Finance survey ($1.81B) within 0.5% tolerance. The $10M difference is due to IPEDS excluding certain inter-entity transfers included in the audited statements.",
    run_at: "2024-08-15T09:00:00Z",
  },
  // --- cross_metric (3) ---
  {
    id: "qc-001-18",
    check_type: "cross_metric",
    check_name: "Enrollment Components Sum",
    description: "Validates that undergraduate + graduate enrollment equals total enrollment",
    severity: "critical",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Undergraduate Enrollment (21,607) + Graduate Enrollment (10,740) = 32,347, which matches Total Fall Enrollment (32,347) exactly. Component sum validation passed.",
    run_at: "2024-08-15T09:00:00Z",
  },
  {
    id: "qc-001-19",
    check_type: "cross_metric",
    check_name: "Revenue vs Cost",
    description: "Checks that total revenue exceeds the product of cost per FTE and total FTE enrollment",
    severity: "info",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Total Operating Revenue ($1.82B) exceeds estimated total cost (FTE enrollment 28,912 x estimated cost per FTE $48,200 = $1.39B). Revenue-to-cost ratio of 1.31 is within the expected range for a state-funded research institution.",
    run_at: "2024-08-15T09:00:00Z",
  },
  {
    id: "qc-001-20",
    check_type: "cross_metric",
    check_name: "Faculty Ratio Consistency",
    description: "Verifies that total enrollment divided by faculty count approximates the reported student-to-faculty ratio",
    severity: "info",
    target_metric_id: M.SF_RATIO,
    target_metric_name: MN[M.SF_RATIO],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "skipped",
    result_detail: "Skipped: Full-Time Faculty count uses a different FTE calculation methodology than the student-to-faculty ratio denominator. The CDS ratio includes part-time faculty on an FTE basis, which cannot be directly reconstructed from headcount data alone. Manual review recommended.",
    run_at: "2024-08-15T09:00:00Z",
  },
];

// ===== REPORT 2: UT Austin 2024 — Score 87, 14 pass / 2 fail / 3 warning / 1 skipped =====

const checksQR002: QualityCheck[] = [
  // --- structural (4) ---
  {
    id: "qc-002-01",
    check_type: "structural",
    check_name: "Value Type Check",
    description: "Ensures each metric value matches its expected data type (numeric, percentage, currency, etc.)",
    severity: "info",
    target_metric_id: M.TUITION_REVENUE,
    target_metric_name: MN[M.TUITION_REVENUE],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "pass",
    result_detail: "All metric values conform to declared types. Net Tuition Revenue stored as numeric currency, enrollment metrics as integer counts, retention and graduation rates as percentages with one decimal precision.",
    run_at: "2024-08-20T10:30:00Z",
  },
  {
    id: "qc-002-02",
    check_type: "structural",
    check_name: "Completeness Check",
    description: "Ensures all required dimensions (fiscal year, entity, peer group) are present for each observation",
    severity: "warning",
    target_metric_id: M.GRAD_RATE_4YR,
    target_metric_name: MN[M.GRAD_RATE_4YR],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "warning",
    result_detail: "Four-Year Graduation Rate is missing the 'cohort_type' dimension. The value appears to be for the full first-time, full-time cohort, but the disaggregation by race/ethnicity and Pell eligibility is not present. These breakdowns are required for peer comparison analysis.",
    expected_value: "Full cohort + disaggregated breakdowns",
    actual_value: "Full cohort only",
    run_at: "2024-08-20T10:30:00Z",
  },
  {
    id: "qc-002-03",
    check_type: "structural",
    check_name: "Unit Consistency",
    description: "Ensures the unit of each observation matches the metric definition's declared unit",
    severity: "info",
    target_metric_id: M.RESEARCH_EXPENDITURE,
    target_metric_name: MN[M.RESEARCH_EXPENDITURE],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "pass",
    result_detail: "Research Expenditures reported in USD (currency) as expected. All 14 metrics have consistent units matching their glossary definitions. No unit conversion was required.",
    run_at: "2024-08-20T10:30:00Z",
  },
  {
    id: "qc-002-04",
    check_type: "structural",
    check_name: "Null Value Check",
    description: "Checks for missing or null values in required metric fields",
    severity: "critical",
    target_metric_id: M.FACULTY_COUNT,
    target_metric_name: MN[M.FACULTY_COUNT],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "pass",
    result_detail: "No null values detected across all required metrics. Full-Time Faculty count is present at 3,124 for FY2024. All observations have valid source references and extraction timestamps.",
    run_at: "2024-08-20T10:30:00Z",
  },
  // --- semantic (5) ---
  {
    id: "qc-002-05",
    check_type: "semantic",
    check_name: "Range Plausibility",
    description: "Checks if the metric value falls within a plausible range for this institution type and size",
    severity: "critical",
    target_metric_id: M.ENDOWMENT,
    target_metric_name: MN[M.ENDOWMENT],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "pass",
    result_detail: "Endowment Market Value of $42.9B is within the plausible range for UT Austin, which manages one of the largest university endowments in the U.S. Historical values range from $28B to $44B over the last 5 years.",
    run_at: "2024-08-20T10:30:00Z",
  },
  {
    id: "qc-002-06",
    check_type: "semantic",
    check_name: "Business Rule: Revenue > Tuition",
    description: "Validates that total operating revenue exceeds net tuition revenue (a logical necessity)",
    severity: "critical",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "pass",
    result_detail: "Total Operating Revenue ($3.87B) exceeds Net Tuition Revenue ($748M). Tuition comprises 19.3% of total revenue, which is expected for a flagship public university with significant research and endowment income.",
    run_at: "2024-08-20T10:30:00Z",
  },
  {
    id: "qc-002-07",
    check_type: "semantic",
    check_name: "Percentage Bound",
    description: "Ensures percentage-type metrics fall within 0-100 range",
    severity: "critical",
    target_metric_id: M.RETENTION_RATE,
    target_metric_name: MN[M.RETENTION_RATE],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "pass",
    result_detail: "First-Year Retention Rate of 96.1% is within the valid 0-100 range. All percentage metrics validated: Retention (96.1%), 4-yr Grad Rate (72.4%), 6-yr Grad Rate (88.3%), Auxiliary Margin (12.7%).",
    run_at: "2024-08-20T10:30:00Z",
  },
  {
    id: "qc-002-08",
    check_type: "semantic",
    check_name: "Non-Negative Value",
    description: "Ensures count and currency metrics are non-negative",
    severity: "warning",
    target_metric_id: M.AUXILIARY_MARGIN,
    target_metric_name: MN[M.AUXILIARY_MARGIN],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "warning",
    result_detail: "Auxiliary Services Margin of 12.7% is positive, but this is notably higher than the prior year value of 3.2%. While not negative, the large swing may indicate a data entry issue or a change in accounting methodology for auxiliary enterprises. Recommend verification with the CFO's office.",
    expected_value: "Positive, consistent with prior year (~3%)",
    actual_value: "12.7% (up from 3.2%)",
    run_at: "2024-08-20T10:30:00Z",
  },
  {
    id: "qc-002-09",
    check_type: "semantic",
    check_name: "Ratio Reasonableness",
    description: "Checks that student-to-faculty ratio falls within a reasonable range of 5:1 to 30:1",
    severity: "warning",
    target_metric_id: M.SF_RATIO,
    target_metric_name: MN[M.SF_RATIO],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "pass",
    result_detail: "Student-to-Faculty Ratio of 17.6:1 falls within the acceptable range of 5:1 to 30:1. This is slightly above the AAU public university median of 15.8:1 but consistent with UT Austin's historically high enrollment relative to faculty size.",
    run_at: "2024-08-20T10:30:00Z",
  },
  // --- temporal (4) ---
  {
    id: "qc-002-10",
    check_type: "temporal",
    check_name: "Year-Over-Year Change",
    description: "Flags any metric with greater than 50% year-over-year change as potentially erroneous",
    severity: "warning",
    target_metric_id: M.RESEARCH_EXPENDITURE,
    target_metric_name: MN[M.RESEARCH_EXPENDITURE],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "pass",
    result_detail: "Research Expenditures changed by +6.1% from FY2023 ($762M) to FY2024 ($808M). This is within the 50% threshold and consistent with the 5-year compound annual growth rate of 5.8%.",
    run_at: "2024-08-20T10:30:00Z",
  },
  {
    id: "qc-002-11",
    check_type: "temporal",
    check_name: "Trend Consistency",
    description: "Checks if the current value is consistent with the 5-year trend line for this metric",
    severity: "critical",
    target_metric_id: M.GRAD_RATE_6YR,
    target_metric_name: MN[M.GRAD_RATE_6YR],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "fail",
    result_detail: "Six-Year Graduation Rate of 88.3% deviates from the 5-year trend prediction of 84.7% (+3.6pp). The trend line based on FY2019-FY2023 values (82.1%, 82.9%, 83.5%, 83.8%, 84.2%) predicts a value near 84.7%. The reported 88.3% represents a statistically significant departure. Possible causes: change in cohort definition, data entry error, or genuine improvement from new student success initiatives.",
    expected_value: "~84.7% (trend prediction)",
    actual_value: "88.3%",
    run_at: "2024-08-20T10:30:00Z",
  },
  {
    id: "qc-002-12",
    check_type: "temporal",
    check_name: "Missing Year Check",
    description: "Verifies there are no gaps in the annual series for each metric",
    severity: "critical",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "pass",
    result_detail: "Total Operating Revenue has a complete annual series from FY2015 through FY2024 with no gaps. All 10 fiscal years have valid observations with source document references.",
    run_at: "2024-08-20T10:30:00Z",
  },
  {
    id: "qc-002-13",
    check_type: "temporal",
    check_name: "Monotonic Check",
    description: "Checks that endowment values do not drop more than 30% year-over-year (market correction threshold)",
    severity: "critical",
    target_metric_id: M.ENDOWMENT,
    target_metric_name: MN[M.ENDOWMENT],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "pass",
    result_detail: "Endowment Market Value year-over-year changes are all within the -30% threshold. Largest decline was -8.9% in FY2022 ($38.4B to $34.9B), consistent with broad market conditions. FY2024 value of $42.9B represents an all-time high.",
    run_at: "2024-08-20T10:30:00Z",
  },
  // --- cross_source (4) ---
  {
    id: "qc-002-14",
    check_type: "cross_source",
    check_name: "IPEDS vs Internal Match",
    description: "Compares enrollment figures from IPEDS with internally reported enrollment data",
    severity: "critical",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "fail",
    result_detail: "IPEDS-reported Total Fall Enrollment (52,384) differs from the internal enrollment census (53,112) by 728 students (1.4%). This exceeds the 1.0% tolerance threshold. The discrepancy may arise from IPEDS excluding certain non-degree-seeking students counted in the institutional census. Recommend reconciliation with the Registrar's office.",
    expected_value: "Match within 1.0% tolerance",
    actual_value: "1.4% discrepancy (728 students)",
    run_at: "2024-08-20T10:30:00Z",
  },
  {
    id: "qc-002-15",
    check_type: "cross_source",
    check_name: "CDS vs IPEDS Enrollment",
    description: "Cross-references Common Data Set enrollment figures against IPEDS for consistency",
    severity: "warning",
    target_metric_id: M.ENROLLMENT_UG,
    target_metric_name: MN[M.ENROLLMENT_UG],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "warning",
    result_detail: "CDS undergraduate enrollment (40,804) differs from IPEDS undergraduate headcount (40,612) by 192 students (0.5%). While within tolerance, the discrepancy is larger than in prior years (<0.1%). The CDS may include provisional admits not yet finalized in the IPEDS census.",
    expected_value: "Match within 1.0%",
    actual_value: "0.5% discrepancy (192 students)",
    run_at: "2024-08-20T10:30:00Z",
  },
  {
    id: "qc-002-16",
    check_type: "cross_source",
    check_name: "Multi-Source Revenue",
    description: "Checks that revenue figures are consistent across audited financials, IPEDS Finance, and internal reports",
    severity: "critical",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "pass",
    result_detail: "Total Operating Revenue from audited financials ($3.87B) aligns with IPEDS Finance ($3.85B) within 0.5% tolerance. Internal budget office reports ($3.87B) match the audited statements exactly.",
    run_at: "2024-08-20T10:30:00Z",
  },
  {
    id: "qc-002-17",
    check_type: "cross_source",
    check_name: "Ranking Data Alignment",
    description: "Checks that US News data aligns with IPEDS data for key reported metrics",
    severity: "info",
    target_metric_id: M.SF_RATIO,
    target_metric_name: MN[M.SF_RATIO],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "pass",
    result_detail: "US News reports a student-to-faculty ratio of 18:1 for UT Austin, while the CDS value is 17.6:1. The difference is within the expected rounding tolerance (US News rounds to nearest integer). IPEDS-derived ratio of 17.5:1 also aligns. Cross-source consistency confirmed.",
    run_at: "2024-08-20T10:30:00Z",
  },
  // --- cross_metric (3) ---
  {
    id: "qc-002-18",
    check_type: "cross_metric",
    check_name: "Enrollment Components Sum",
    description: "Validates that undergraduate + graduate enrollment equals total enrollment",
    severity: "critical",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "pass",
    result_detail: "Undergraduate Enrollment (40,612) + Graduate Enrollment (11,772) = 52,384, which matches Total Fall Enrollment (52,384) from IPEDS. Component sum validation passed.",
    run_at: "2024-08-20T10:30:00Z",
  },
  {
    id: "qc-002-19",
    check_type: "cross_metric",
    check_name: "Revenue vs Cost",
    description: "Checks that total revenue exceeds the product of cost per FTE and total FTE enrollment",
    severity: "info",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "pass",
    result_detail: "Total Operating Revenue ($3.87B) exceeds estimated total cost (FTE enrollment 46,800 x estimated cost per FTE $52,400 = $2.45B). Revenue-to-cost ratio of 1.58 reflects UT Austin's substantial research enterprise and endowment income.",
    run_at: "2024-08-20T10:30:00Z",
  },
  {
    id: "qc-002-20",
    check_type: "cross_metric",
    check_name: "Faculty Ratio Consistency",
    description: "Verifies that total enrollment divided by faculty count approximates the reported student-to-faculty ratio",
    severity: "info",
    target_metric_id: M.SF_RATIO,
    target_metric_name: MN[M.SF_RATIO],
    target_entity_id: "inst-002",
    target_entity_name: "UT Austin",
    status: "skipped",
    result_detail: "Skipped: The student-to-faculty ratio from the CDS (17.6:1) uses FTE-adjusted figures that cannot be directly computed from Total Fall Enrollment (headcount) and Full-Time Faculty (headcount) alone. Part-time faculty FTE conversion factors are not available in the current dataset.",
    run_at: "2024-08-20T10:30:00Z",
  },
];

// ===== REPORT 3: U of Michigan 2024 — Score 95, 18 pass / 0 fail / 1 warning / 1 skipped =====

const checksQR003: QualityCheck[] = [
  // --- structural (5) ---
  {
    id: "qc-003-01",
    check_type: "structural",
    check_name: "Value Type Check",
    description: "Ensures each metric value matches its expected data type (numeric, percentage, currency, etc.)",
    severity: "info",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "All 14 submitted metric values conform to their declared types. Enrollment counts are valid integers, currency values are numeric without formatting artifacts, and percentages are within 0-100.",
    run_at: "2024-08-22T14:00:00Z",
  },
  {
    id: "qc-003-02",
    check_type: "structural",
    check_name: "Completeness Check",
    description: "Ensures all required dimensions (fiscal year, entity, peer group) are present for each observation",
    severity: "info",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "All required dimensions are present for every metric observation. Fiscal year, entity, and peer group mappings are complete. Dimensional breakdowns for enrollment (UG/Grad) and graduation rates (4-yr/6-yr) are fully populated.",
    run_at: "2024-08-22T14:00:00Z",
  },
  {
    id: "qc-003-03",
    check_type: "structural",
    check_name: "Unit Consistency",
    description: "Ensures the unit of each observation matches the metric definition's declared unit",
    severity: "info",
    target_metric_id: M.TUITION_REVENUE,
    target_metric_name: MN[M.TUITION_REVENUE],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "Net Tuition Revenue is reported in USD as expected. Currency metrics use nominal dollars; all units across 14 metrics match their glossary definitions without conversion issues.",
    run_at: "2024-08-22T14:00:00Z",
  },
  {
    id: "qc-003-04",
    check_type: "structural",
    check_name: "Null Value Check",
    description: "Checks for missing or null values in required metric fields",
    severity: "critical",
    target_metric_id: M.DEFERRED_MAINTENANCE,
    target_metric_name: MN[M.DEFERRED_MAINTENANCE],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "No null or missing values detected. All 14 required metrics have valid observations for FY2024. Deferred Maintenance Backlog of $2.1B is present with a source reference to the FY2024 facilities condition report.",
    run_at: "2024-08-22T14:00:00Z",
  },
  {
    id: "qc-003-05",
    check_type: "structural",
    check_name: "Format Validation",
    description: "Checks that numeric values conform to expected format (decimal places, thousands separators stripped)",
    severity: "info",
    target_metric_id: M.RETENTION_RATE,
    target_metric_name: MN[M.RETENTION_RATE],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "First-Year Retention Rate of 97.3% correctly stored as 97.3 (one decimal place). All numeric values conform to expected precision: counts as integers, currencies as whole dollars, percentages with one decimal.",
    run_at: "2024-08-22T14:00:00Z",
  },
  // --- semantic (4) ---
  {
    id: "qc-003-06",
    check_type: "semantic",
    check_name: "Range Plausibility",
    description: "Checks if the metric value falls within a plausible range for this institution type and size",
    severity: "info",
    target_metric_id: M.ENDOWMENT,
    target_metric_name: MN[M.ENDOWMENT],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "Endowment Market Value of $17.9B is within the expected range for the University of Michigan ($14B-$18B over the last 5 years). U of M consistently ranks among the top 10 university endowments nationally.",
    run_at: "2024-08-22T14:00:00Z",
  },
  {
    id: "qc-003-07",
    check_type: "semantic",
    check_name: "Business Rule: Revenue > Tuition",
    description: "Validates that total operating revenue exceeds net tuition revenue (a logical necessity)",
    severity: "critical",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "Total Operating Revenue ($10.93B) significantly exceeds Net Tuition Revenue ($1.62B). Tuition represents only 14.8% of total revenue, reflecting U of M's massive health system, research enterprise, and investment income.",
    run_at: "2024-08-22T14:00:00Z",
  },
  {
    id: "qc-003-08",
    check_type: "semantic",
    check_name: "Percentage Bound",
    description: "Ensures percentage-type metrics fall within 0-100 range",
    severity: "critical",
    target_metric_id: M.GRAD_RATE_4YR,
    target_metric_name: MN[M.GRAD_RATE_4YR],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "Four-Year Graduation Rate of 79.5% is within the valid 0-100 range. All percentage metrics validated: Retention (97.3%), 4-yr Grad Rate (79.5%), 6-yr Grad Rate (93.2%), Auxiliary Margin (8.4%).",
    run_at: "2024-08-22T14:00:00Z",
  },
  {
    id: "qc-003-09",
    check_type: "semantic",
    check_name: "Ratio Reasonableness",
    description: "Checks that student-to-faculty ratio falls within a reasonable range of 5:1 to 30:1",
    severity: "warning",
    target_metric_id: M.SF_RATIO,
    target_metric_name: MN[M.SF_RATIO],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "Student-to-Faculty Ratio of 11.5:1 falls within the 5:1 to 30:1 range. This is at the lower end for public universities, reflecting U of M's strong faculty investment and competitive positioning.",
    run_at: "2024-08-22T14:00:00Z",
  },
  // --- temporal (4) ---
  {
    id: "qc-003-10",
    check_type: "temporal",
    check_name: "Year-Over-Year Change",
    description: "Flags any metric with greater than 50% year-over-year change as potentially erroneous",
    severity: "warning",
    target_metric_id: M.DEFERRED_MAINTENANCE,
    target_metric_name: MN[M.DEFERRED_MAINTENANCE],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "warning",
    result_detail: "Deferred Maintenance Backlog increased by +18.2% from FY2023 ($1.78B) to FY2024 ($2.10B). While within the 50% threshold, this is the largest single-year increase in the 5-year series. The jump is likely due to the updated facilities condition assessment methodology adopted in FY2024 that includes infrastructure systems not previously assessed.",
    expected_value: "Change within +/- 50%",
    actual_value: "+18.2% year-over-year ($320M increase)",
    run_at: "2024-08-22T14:00:00Z",
  },
  {
    id: "qc-003-11",
    check_type: "temporal",
    check_name: "Trend Consistency",
    description: "Checks if the current value is consistent with the 5-year trend line for this metric",
    severity: "critical",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "Total Fall Enrollment of 47,907 is consistent with the 5-year trend (46,716 -> 47,070 -> 47,275 -> 47,600 -> 47,907). The 0.6% annual growth rate aligns with the predicted trend value of 47,850 (+/- 200).",
    run_at: "2024-08-22T14:00:00Z",
  },
  {
    id: "qc-003-12",
    check_type: "temporal",
    check_name: "Missing Year Check",
    description: "Verifies there are no gaps in the annual series for each metric",
    severity: "critical",
    target_metric_id: M.RESEARCH_EXPENDITURE,
    target_metric_name: MN[M.RESEARCH_EXPENDITURE],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "Research Expenditures has a complete annual series from FY2015 through FY2024 (10 consecutive years). No missing years detected. All values have corresponding HERD survey source references.",
    run_at: "2024-08-22T14:00:00Z",
  },
  {
    id: "qc-003-13",
    check_type: "temporal",
    check_name: "Monotonic Check",
    description: "Checks that endowment values do not drop more than 30% year-over-year (market correction threshold)",
    severity: "critical",
    target_metric_id: M.ENDOWMENT,
    target_metric_name: MN[M.ENDOWMENT],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "Endowment Market Value year-over-year changes are all within the -30% threshold. The largest decline was -7.8% in FY2022 ($17.3B to $15.9B). FY2024 value of $17.9B sets a new high, reflecting strong investment returns.",
    run_at: "2024-08-22T14:00:00Z",
  },
  // --- cross_source (3) ---
  {
    id: "qc-003-14",
    check_type: "cross_source",
    check_name: "IPEDS vs Internal Match",
    description: "Compares enrollment figures from IPEDS with internally reported enrollment data",
    severity: "critical",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "IPEDS-reported Total Fall Enrollment (47,907) matches the internal enrollment census (47,911) within 0.01% tolerance. The 4-student difference is negligible and within the expected variance from census date timing.",
    run_at: "2024-08-22T14:00:00Z",
  },
  {
    id: "qc-003-15",
    check_type: "cross_source",
    check_name: "CDS vs IPEDS Enrollment",
    description: "Cross-references Common Data Set enrollment figures against IPEDS for consistency",
    severity: "warning",
    target_metric_id: M.ENROLLMENT_GRAD,
    target_metric_name: MN[M.ENROLLMENT_GRAD],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "CDS graduate enrollment (16,410) matches IPEDS graduate headcount (16,410) exactly. Undergraduate figures also match (31,497 in both sources). Full cross-source consistency for all enrollment components.",
    run_at: "2024-08-22T14:00:00Z",
  },
  {
    id: "qc-003-16",
    check_type: "cross_source",
    check_name: "Multi-Source Revenue",
    description: "Checks that revenue figures are consistent across audited financials, IPEDS Finance, and internal reports",
    severity: "critical",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "Total Operating Revenue from audited financials ($10.93B) aligns with IPEDS Finance ($10.89B) within 0.4% tolerance. The difference is attributable to IPEDS classification of Michigan Medicine revenues. Internal budget reports ($10.93B) match audited statements.",
    run_at: "2024-08-22T14:00:00Z",
  },
  // --- cross_metric (4) ---
  {
    id: "qc-003-17",
    check_type: "cross_metric",
    check_name: "Enrollment Components Sum",
    description: "Validates that undergraduate + graduate enrollment equals total enrollment",
    severity: "critical",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "Undergraduate Enrollment (31,497) + Graduate Enrollment (16,410) = 47,907, which matches Total Fall Enrollment (47,907) exactly. Component sum validation passed.",
    run_at: "2024-08-22T14:00:00Z",
  },
  {
    id: "qc-003-18",
    check_type: "cross_metric",
    check_name: "Revenue vs Cost",
    description: "Checks that total revenue exceeds the product of cost per FTE and total FTE enrollment",
    severity: "info",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "Total Operating Revenue ($10.93B) greatly exceeds estimated instructional cost (FTE enrollment 42,500 x estimated cost per FTE $45,800 = $1.95B). The high ratio of 5.6 reflects the inclusion of Michigan Medicine health system revenue in operating totals.",
    run_at: "2024-08-22T14:00:00Z",
  },
  {
    id: "qc-003-19",
    check_type: "cross_metric",
    check_name: "Faculty Ratio Consistency",
    description: "Verifies that total enrollment divided by faculty count approximates the reported student-to-faculty ratio",
    severity: "info",
    target_metric_id: M.SF_RATIO,
    target_metric_name: MN[M.SF_RATIO],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "pass",
    result_detail: "Computed ratio: Total Fall Enrollment (47,907) / Full-Time Faculty (3,829) = 12.5:1. Reported CDS ratio is 11.5:1. The 1.0 difference is expected because the CDS uses FTE students (lower than headcount) and includes part-time faculty on an FTE basis. Directionally consistent.",
    run_at: "2024-08-22T14:00:00Z",
  },
  {
    id: "qc-003-20",
    check_type: "cross_metric",
    check_name: "Non-Negative Value",
    description: "Ensures count and currency metrics are non-negative",
    severity: "info",
    target_metric_id: M.FACULTY_COUNT,
    target_metric_name: MN[M.FACULTY_COUNT],
    target_entity_id: "inst-003",
    target_entity_name: "U of Michigan",
    status: "skipped",
    result_detail: "Skipped: This check is a duplicate of the semantic non-negative value check (qc-003-08 equivalent). Deduplication logic identified this as redundant. The semantic layer check already validated all count and currency metrics are non-negative.",
    run_at: "2024-08-22T14:00:00Z",
  },
];

// ===== REPORT 4: UC Berkeley 2024 — Score 78, 11 pass / 4 fail / 3 warning / 2 skipped =====
// Lower-scored report with meaningful failures

const checksQR004: QualityCheck[] = [
  // --- structural (5) ---
  {
    id: "qc-004-01",
    check_type: "structural",
    check_name: "Value Type Check",
    description: "Ensures each metric value matches its expected data type (numeric, percentage, currency, etc.)",
    severity: "info",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "pass",
    result_detail: "All submitted metric values match their declared data types. Revenue stored as numeric currency, enrollment as integers, rates as percentages. No type coercion errors detected.",
    run_at: "2024-09-01T08:00:00Z",
  },
  {
    id: "qc-004-02",
    check_type: "structural",
    check_name: "Completeness Check",
    description: "Ensures all required dimensions (fiscal year, entity, peer group) are present for each observation",
    severity: "warning",
    target_metric_id: M.ENROLLMENT_GRAD,
    target_metric_name: MN[M.ENROLLMENT_GRAD],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "warning",
    result_detail: "Graduate Enrollment is present as an aggregate count but is missing the 'degree_level' dimension breakdown (master's vs. doctoral vs. professional). This breakdown is required for peer comparison dashboards and for computing doctoral student funding ratios.",
    expected_value: "Aggregate + degree_level breakdown",
    actual_value: "Aggregate only",
    run_at: "2024-09-01T08:00:00Z",
  },
  {
    id: "qc-004-03",
    check_type: "structural",
    check_name: "Unit Consistency",
    description: "Ensures the unit of each observation matches the metric definition's declared unit",
    severity: "info",
    target_metric_id: M.ENDOWMENT,
    target_metric_name: MN[M.ENDOWMENT],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "pass",
    result_detail: "Endowment Market Value reported in USD as required. All currency-type metrics use nominal USD. No unit mismatches detected.",
    run_at: "2024-09-01T08:00:00Z",
  },
  {
    id: "qc-004-04",
    check_type: "structural",
    check_name: "Null Value Check",
    description: "Checks for missing or null values in required metric fields",
    severity: "critical",
    target_metric_id: M.FACULTY_COUNT,
    target_metric_name: MN[M.FACULTY_COUNT],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "fail",
    result_detail: "CRITICAL: Full-Time Faculty count is NULL for FY2024. The IPEDS Human Resources survey data for UC Berkeley has not been submitted for the current reporting cycle. The most recent available value is FY2023 (1,752). This missing data impacts the student-to-faculty ratio calculation and multiple cross-metric checks. Recommend contacting the Office of Planning & Analysis.",
    expected_value: "Non-null integer value",
    actual_value: "NULL",
    run_at: "2024-09-01T08:00:00Z",
  },
  {
    id: "qc-004-05",
    check_type: "structural",
    check_name: "Format Validation",
    description: "Checks that numeric values conform to expected format (decimal places, thousands separators stripped)",
    severity: "info",
    target_metric_id: M.GRAD_RATE_6YR,
    target_metric_name: MN[M.GRAD_RATE_6YR],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "pass",
    result_detail: "Six-Year Graduation Rate of 93.0% correctly stored with one decimal place. All available numeric values conform to expected precision rules. No formatting artifacts or parsing errors in the submitted data.",
    run_at: "2024-09-01T08:00:00Z",
  },
  // --- semantic (5) ---
  {
    id: "qc-004-06",
    check_type: "semantic",
    check_name: "Range Plausibility",
    description: "Checks if the metric value falls within a plausible range for this institution type and size",
    severity: "critical",
    target_metric_id: M.ENDOWMENT,
    target_metric_name: MN[M.ENDOWMENT],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "fail",
    result_detail: "CRITICAL: Endowment Market Value of $32.4B appears implausibly high for UC Berkeley. Historical values range from $4.8B to $7.2B over the last 5 years. The reported value is approximately 4.5x the expected range. This likely represents the entire UC system endowment ($32.4B) rather than UC Berkeley's campus-specific share (~$6.8B). The data source may be the UC Regents Investment Report, which reports at the system level.",
    expected_value: "$5.0B - $8.0B (campus-specific)",
    actual_value: "$32.4B (likely system-wide figure)",
    run_at: "2024-09-01T08:00:00Z",
  },
  {
    id: "qc-004-07",
    check_type: "semantic",
    check_name: "Business Rule: Revenue > Tuition",
    description: "Validates that total operating revenue exceeds net tuition revenue (a logical necessity)",
    severity: "critical",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "pass",
    result_detail: "Total Operating Revenue ($3.41B) exceeds Net Tuition Revenue ($892M). Tuition represents 26.2% of total revenue. Validation passed.",
    run_at: "2024-09-01T08:00:00Z",
  },
  {
    id: "qc-004-08",
    check_type: "semantic",
    check_name: "Percentage Bound",
    description: "Ensures percentage-type metrics fall within 0-100 range",
    severity: "critical",
    target_metric_id: M.RETENTION_RATE,
    target_metric_name: MN[M.RETENTION_RATE],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "pass",
    result_detail: "First-Year Retention Rate of 97.0% is within the valid 0-100 range. All available percentage metrics validated within bounds: Retention (97.0%), 4-yr Grad Rate (76.2%), 6-yr Grad Rate (93.0%), Auxiliary Margin (5.1%).",
    run_at: "2024-09-01T08:00:00Z",
  },
  {
    id: "qc-004-09",
    check_type: "semantic",
    check_name: "Non-Negative Value",
    description: "Ensures count and currency metrics are non-negative",
    severity: "warning",
    target_metric_id: M.AUXILIARY_MARGIN,
    target_metric_name: MN[M.AUXILIARY_MARGIN],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "warning",
    result_detail: "Auxiliary Services Margin of 5.1% is positive but has been declining steadily over 3 years (9.8% -> 7.2% -> 5.1%). If the trend continues, the margin may turn negative in FY2025. Flagging for proactive review by the auxiliary services division.",
    expected_value: "Positive value, stable or growing",
    actual_value: "5.1% (declining trend)",
    run_at: "2024-09-01T08:00:00Z",
  },
  {
    id: "qc-004-10",
    check_type: "semantic",
    check_name: "Ratio Reasonableness",
    description: "Checks that student-to-faculty ratio falls within a reasonable range of 5:1 to 30:1",
    severity: "warning",
    target_metric_id: M.SF_RATIO,
    target_metric_name: MN[M.SF_RATIO],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "pass",
    result_detail: "Student-to-Faculty Ratio of 20.3:1 falls within the 5:1 to 30:1 range. However, this is notably higher than the AAU public university median of 15.8:1 and UC Berkeley's historical range of 17:1 to 19:1. The increase may be related to the missing FY2024 faculty count data (using FY2023 fallback).",
    run_at: "2024-09-01T08:00:00Z",
  },
  // --- temporal (3) ---
  {
    id: "qc-004-11",
    check_type: "temporal",
    check_name: "Year-Over-Year Change",
    description: "Flags any metric with greater than 50% year-over-year change as potentially erroneous",
    severity: "warning",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "fail",
    result_detail: "CRITICAL: Total Operating Revenue dropped by -15.2% from FY2023 ($4.02B) to FY2024 ($3.41B), a decline of $610M. While within the 50% absolute threshold, a double-digit revenue decline at a major public research university is highly unusual and warrants immediate investigation. Possible causes: change in revenue recognition policy, exclusion of a revenue category, or a data extraction error from the audited financial statements.",
    expected_value: "Change within +/- 10% (typical range)",
    actual_value: "-15.2% year-over-year ($610M decline)",
    run_at: "2024-09-01T08:00:00Z",
  },
  {
    id: "qc-004-12",
    check_type: "temporal",
    check_name: "Trend Consistency",
    description: "Checks if the current value is consistent with the 5-year trend line for this metric",
    severity: "critical",
    target_metric_id: M.RETENTION_RATE,
    target_metric_name: MN[M.RETENTION_RATE],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "pass",
    result_detail: "First-Year Retention Rate of 97.0% is consistent with the 5-year trend (96.5%, 96.7%, 96.8%, 96.9%, 97.0%). The gradual improvement aligns with the predicted trend value of 97.1% (+/- 0.3pp).",
    run_at: "2024-09-01T08:00:00Z",
  },
  {
    id: "qc-004-13",
    check_type: "temporal",
    check_name: "Missing Year Check",
    description: "Verifies there are no gaps in the annual series for each metric",
    severity: "critical",
    target_metric_id: M.TUITION_REVENUE,
    target_metric_name: MN[M.TUITION_REVENUE],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "pass",
    result_detail: "Net Tuition Revenue has a complete annual series from FY2015 through FY2024. No gaps detected in the 10-year time series.",
    run_at: "2024-09-01T08:00:00Z",
  },
  // --- cross_source (4) ---
  {
    id: "qc-004-14",
    check_type: "cross_source",
    check_name: "IPEDS vs Internal Match",
    description: "Compares enrollment figures from IPEDS with internally reported enrollment data",
    severity: "critical",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "fail",
    result_detail: "CRITICAL: IPEDS-reported Total Fall Enrollment (45,307) differs from internal enrollment census (43,185) by 2,122 students (4.7%). This greatly exceeds the 1.0% tolerance threshold. Investigation reveals that the IPEDS figure includes UC Berkeley Extension students while the internal census does not. Data definitions must be aligned across sources. Recommend standardizing the enrollment definition to exclude non-degree extension students.",
    expected_value: "Match within 1.0% tolerance",
    actual_value: "4.7% discrepancy (2,122 students)",
    run_at: "2024-09-01T08:00:00Z",
  },
  {
    id: "qc-004-15",
    check_type: "cross_source",
    check_name: "CDS vs IPEDS Enrollment",
    description: "Cross-references Common Data Set enrollment figures against IPEDS for consistency",
    severity: "warning",
    target_metric_id: M.ENROLLMENT_UG,
    target_metric_name: MN[M.ENROLLMENT_UG],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "warning",
    result_detail: "CDS undergraduate enrollment (31,814) differs from IPEDS undergraduate headcount (32,479) by 665 students (2.1%). This is consistent with the broader enrollment definition discrepancy noted in the IPEDS vs Internal check. CDS likely excludes extension students while IPEDS includes them.",
    expected_value: "Match within 1.0%",
    actual_value: "2.1% discrepancy (665 students)",
    run_at: "2024-09-01T08:00:00Z",
  },
  {
    id: "qc-004-16",
    check_type: "cross_source",
    check_name: "Multi-Source Revenue",
    description: "Checks that revenue figures are consistent across audited financials, IPEDS Finance, and internal reports",
    severity: "critical",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "pass",
    result_detail: "Total Operating Revenue from audited financials ($3.41B) aligns with IPEDS Finance ($3.39B) within 0.6% tolerance. Note: the 15.2% year-over-year decline is confirmed across both sources, so it is not a cross-source error but a genuine (or systematically misreported) change.",
    run_at: "2024-09-01T08:00:00Z",
  },
  {
    id: "qc-004-17",
    check_type: "cross_source",
    check_name: "Ranking Data Alignment",
    description: "Checks that US News data aligns with IPEDS data for key reported metrics",
    severity: "info",
    target_metric_id: M.GRAD_RATE_6YR,
    target_metric_name: MN[M.GRAD_RATE_6YR],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "pass",
    result_detail: "US News reports a 6-year graduation rate of 93% for UC Berkeley, which matches the IPEDS-derived value of 93.0% exactly. The CDS also reports 93%. Full cross-source alignment confirmed for this metric.",
    run_at: "2024-09-01T08:00:00Z",
  },
  // --- cross_metric (3) ---
  {
    id: "qc-004-18",
    check_type: "cross_metric",
    check_name: "Enrollment Components Sum",
    description: "Validates that undergraduate + graduate enrollment equals total enrollment",
    severity: "critical",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "pass",
    result_detail: "Using IPEDS figures: Undergraduate Enrollment (32,479) + Graduate Enrollment (12,828) = 45,307, which matches Total Fall Enrollment (45,307). Component sum is internally consistent within the IPEDS data source.",
    run_at: "2024-09-01T08:00:00Z",
  },
  {
    id: "qc-004-19",
    check_type: "cross_metric",
    check_name: "Revenue vs Cost",
    description: "Checks that total revenue exceeds the product of cost per FTE and total FTE enrollment",
    severity: "info",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "skipped",
    result_detail: "Skipped: Due to the 15.2% revenue decline flagged in the temporal check, the revenue-to-cost ratio would be unreliable. This check is deferred pending resolution of the revenue data quality issue in qc-004-11.",
    run_at: "2024-09-01T08:00:00Z",
  },
  {
    id: "qc-004-20",
    check_type: "cross_metric",
    check_name: "Faculty Ratio Consistency",
    description: "Verifies that total enrollment divided by faculty count approximates the reported student-to-faculty ratio",
    severity: "info",
    target_metric_id: M.SF_RATIO,
    target_metric_name: MN[M.SF_RATIO],
    target_entity_id: "inst-004",
    target_entity_name: "UC Berkeley",
    status: "skipped",
    result_detail: "Skipped: Full-Time Faculty count is NULL for FY2024 (see qc-004-04). Cannot compute enrollment-to-faculty ratio without the denominator. This check will be re-run once FY2024 faculty data is submitted.",
    run_at: "2024-09-01T08:00:00Z",
  },
];

// ===== REPORT 5: Ohio State 2024 — Score 84, 13 pass / 3 fail / 2 warning / 2 skipped =====

const checksQR005: QualityCheck[] = [
  // --- structural (4) ---
  {
    id: "qc-005-01",
    check_type: "structural",
    check_name: "Value Type Check",
    description: "Ensures each metric value matches its expected data type (numeric, percentage, currency, etc.)",
    severity: "info",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "pass",
    result_detail: "All 14 metric values conform to their declared types. Enrollment counts parsed as valid integers from IPEDS, currency values as numeric, and rates as percentages. No type mismatches detected.",
    run_at: "2024-09-05T11:15:00Z",
  },
  {
    id: "qc-005-02",
    check_type: "structural",
    check_name: "Completeness Check",
    description: "Ensures all required dimensions (fiscal year, entity, peer group) are present for each observation",
    severity: "warning",
    target_metric_id: M.RESEARCH_EXPENDITURE,
    target_metric_name: MN[M.RESEARCH_EXPENDITURE],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "warning",
    result_detail: "Research Expenditures is present as a total figure ($1.09B) but is missing the 'funding_source' dimension (federal vs. state vs. industry vs. institutional). This breakdown is needed for the research portfolio analysis dashboard.",
    expected_value: "Total + funding_source breakdown",
    actual_value: "Total only",
    run_at: "2024-09-05T11:15:00Z",
  },
  {
    id: "qc-005-03",
    check_type: "structural",
    check_name: "Unit Consistency",
    description: "Ensures the unit of each observation matches the metric definition's declared unit",
    severity: "info",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "pass",
    result_detail: "Total Operating Revenue reported in USD (currency) as expected. All metric units are consistent with their glossary definitions. No unit conversion required.",
    run_at: "2024-09-05T11:15:00Z",
  },
  {
    id: "qc-005-04",
    check_type: "structural",
    check_name: "Null Value Check",
    description: "Checks for missing or null values in required metric fields",
    severity: "critical",
    target_metric_id: M.DEFERRED_MAINTENANCE,
    target_metric_name: MN[M.DEFERRED_MAINTENANCE],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "pass",
    result_detail: "No null values detected. All 14 required metrics have valid observations for FY2024 including Deferred Maintenance Backlog of $1.87B sourced from the FY2024 capital plan.",
    run_at: "2024-09-05T11:15:00Z",
  },
  // --- semantic (5) ---
  {
    id: "qc-005-05",
    check_type: "semantic",
    check_name: "Range Plausibility",
    description: "Checks if the metric value falls within a plausible range for this institution type and size",
    severity: "critical",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "pass",
    result_detail: "Total Fall Enrollment of 61,369 is within the expected range for Ohio State (58,000-62,000 over the last 5 years). Ohio State is among the largest universities in the U.S. by enrollment, so this high figure is plausible.",
    run_at: "2024-09-05T11:15:00Z",
  },
  {
    id: "qc-005-06",
    check_type: "semantic",
    check_name: "Business Rule: Revenue > Tuition",
    description: "Validates that total operating revenue exceeds net tuition revenue (a logical necessity)",
    severity: "critical",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "pass",
    result_detail: "Total Operating Revenue ($7.64B) exceeds Net Tuition Revenue ($1.35B). Tuition represents 17.7% of total revenue. The low tuition share is consistent with Ohio State's large medical center and research enterprise.",
    run_at: "2024-09-05T11:15:00Z",
  },
  {
    id: "qc-005-07",
    check_type: "semantic",
    check_name: "Percentage Bound",
    description: "Ensures percentage-type metrics fall within 0-100 range",
    severity: "critical",
    target_metric_id: M.GRAD_RATE_6YR,
    target_metric_name: MN[M.GRAD_RATE_6YR],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "pass",
    result_detail: "Six-Year Graduation Rate of 84.7% is within the valid 0-100 range. All percentage metrics validated: Retention (94.2%), 4-yr Grad Rate (68.1%), 6-yr Grad Rate (84.7%), Auxiliary Margin (7.3%).",
    run_at: "2024-09-05T11:15:00Z",
  },
  {
    id: "qc-005-08",
    check_type: "semantic",
    check_name: "Non-Negative Value",
    description: "Ensures count and currency metrics are non-negative",
    severity: "warning",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "pass",
    result_detail: "All count and currency metrics are non-negative. Total Operating Revenue ($7.64B), Endowment ($7.15B), Research Expenditures ($1.09B), and all enrollment counts are positive values.",
    run_at: "2024-09-05T11:15:00Z",
  },
  {
    id: "qc-005-09",
    check_type: "semantic",
    check_name: "Ratio Reasonableness",
    description: "Checks that student-to-faculty ratio falls within a reasonable range of 5:1 to 30:1",
    severity: "warning",
    target_metric_id: M.SF_RATIO,
    target_metric_name: MN[M.SF_RATIO],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "warning",
    result_detail: "Student-to-Faculty Ratio of 19.1:1 falls within the 5:1 to 30:1 range but is at the upper end for AAU institutions (median 15.8:1). This is attributable to Ohio State's very large undergraduate enrollment relative to faculty. The ratio has been gradually increasing over the last 3 years (18.2 -> 18.7 -> 19.1), which may signal a need for faculty hiring.",
    expected_value: "13:1 to 18:1 (AAU public range)",
    actual_value: "19.1:1",
    run_at: "2024-09-05T11:15:00Z",
  },
  // --- temporal (3) ---
  {
    id: "qc-005-10",
    check_type: "temporal",
    check_name: "Year-Over-Year Change",
    description: "Flags any metric with greater than 50% year-over-year change as potentially erroneous",
    severity: "warning",
    target_metric_id: M.ENDOWMENT,
    target_metric_name: MN[M.ENDOWMENT],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "pass",
    result_detail: "Endowment Market Value changed by +9.8% from FY2023 ($6.51B) to FY2024 ($7.15B). This is within the 50% threshold and consistent with broad market returns for the period. All other metrics show year-over-year changes under 10%.",
    run_at: "2024-09-05T11:15:00Z",
  },
  {
    id: "qc-005-11",
    check_type: "temporal",
    check_name: "Trend Consistency",
    description: "Checks if the current value is consistent with the 5-year trend line for this metric",
    severity: "critical",
    target_metric_id: M.GRAD_RATE_4YR,
    target_metric_name: MN[M.GRAD_RATE_4YR],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "fail",
    result_detail: "Four-Year Graduation Rate of 68.1% deviates from the 5-year trend prediction of 62.5% (+5.6pp). The historical series (57.3%, 58.9%, 60.2%, 61.1%, 62.0%) predicts a value near 62.5%. The jump to 68.1% is statistically significant (>2 standard deviations). Possible causes: change in cohort definition, inclusion of transfer students, or data processing error.",
    expected_value: "~62.5% (trend prediction)",
    actual_value: "68.1%",
    run_at: "2024-09-05T11:15:00Z",
  },
  {
    id: "qc-005-12",
    check_type: "temporal",
    check_name: "Missing Year Check",
    description: "Verifies there are no gaps in the annual series for each metric",
    severity: "critical",
    target_metric_id: M.AUXILIARY_MARGIN,
    target_metric_name: MN[M.AUXILIARY_MARGIN],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "pass",
    result_detail: "Auxiliary Services Margin has a complete annual series from FY2017 through FY2024 (8 consecutive years). The metric was introduced in FY2017 so earlier years are not expected. No gaps within the available series.",
    run_at: "2024-09-05T11:15:00Z",
  },
  // --- cross_source (4) ---
  {
    id: "qc-005-13",
    check_type: "cross_source",
    check_name: "IPEDS vs Internal Match",
    description: "Compares enrollment figures from IPEDS with internally reported enrollment data",
    severity: "critical",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "pass",
    result_detail: "IPEDS-reported Total Fall Enrollment (61,369) matches the internal enrollment census (61,342) within 0.04% tolerance. The 27-student difference is within acceptable variance and likely due to census date timing.",
    run_at: "2024-09-05T11:15:00Z",
  },
  {
    id: "qc-005-14",
    check_type: "cross_source",
    check_name: "CDS vs IPEDS Enrollment",
    description: "Cross-references Common Data Set enrollment figures against IPEDS for consistency",
    severity: "warning",
    target_metric_id: M.ENROLLMENT_UG,
    target_metric_name: MN[M.ENROLLMENT_UG],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "pass",
    result_detail: "CDS undergraduate enrollment (46,820) matches IPEDS undergraduate headcount (46,820) exactly. Graduate enrollment also aligns: CDS (14,549) vs. IPEDS (14,549). Full cross-source consistency confirmed.",
    run_at: "2024-09-05T11:15:00Z",
  },
  {
    id: "qc-005-15",
    check_type: "cross_source",
    check_name: "Multi-Source Revenue",
    description: "Checks that revenue figures are consistent across audited financials, IPEDS Finance, and internal reports",
    severity: "critical",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "fail",
    result_detail: "Total Operating Revenue from audited financials ($7.64B) differs from IPEDS Finance ($7.21B) by $430M (5.6%). This exceeds the 1.0% tolerance threshold. Investigation shows the audited financials include OSU Wexner Medical Center revenues on a gross basis while IPEDS reports net patient service revenue. Recommend establishing a standard revenue definition that specifies gross vs. net treatment of health system revenues.",
    expected_value: "Match within 1.0% tolerance",
    actual_value: "5.6% discrepancy ($430M)",
    run_at: "2024-09-05T11:15:00Z",
  },
  {
    id: "qc-005-16",
    check_type: "cross_source",
    check_name: "Ranking Data Alignment",
    description: "Checks that US News data aligns with IPEDS data for key reported metrics",
    severity: "info",
    target_metric_id: M.RETENTION_RATE,
    target_metric_name: MN[M.RETENTION_RATE],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "pass",
    result_detail: "US News reports a first-year retention rate of 94% for Ohio State, which matches the IPEDS/CDS value of 94.2% (US News rounds to nearest integer). Cross-source alignment confirmed.",
    run_at: "2024-09-05T11:15:00Z",
  },
  // --- cross_metric (4) ---
  {
    id: "qc-005-17",
    check_type: "cross_metric",
    check_name: "Enrollment Components Sum",
    description: "Validates that undergraduate + graduate enrollment equals total enrollment",
    severity: "critical",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "pass",
    result_detail: "Undergraduate Enrollment (46,820) + Graduate Enrollment (14,549) = 61,369, which matches Total Fall Enrollment (61,369) exactly. Component sum validation passed.",
    run_at: "2024-09-05T11:15:00Z",
  },
  {
    id: "qc-005-18",
    check_type: "cross_metric",
    check_name: "Revenue vs Cost",
    description: "Checks that total revenue exceeds the product of cost per FTE and total FTE enrollment",
    severity: "info",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "fail",
    result_detail: "Using IPEDS revenue ($7.21B) and estimated total cost (FTE enrollment 53,200 x estimated cost per FTE $41,900 = $2.23B), revenue-to-cost ratio is 3.23. However, when using audited financial revenue ($7.64B), the ratio jumps to 3.43. The significant difference between ratios depending on the revenue source undermines confidence in this cross-metric check. Flagging as a failure due to inconsistent inputs; revenue source alignment (qc-005-15) must be resolved first.",
    expected_value: "Consistent ratio regardless of revenue source",
    actual_value: "3.23 (IPEDS) vs 3.43 (audited) — 6% spread",
    run_at: "2024-09-05T11:15:00Z",
  },
  {
    id: "qc-005-19",
    check_type: "cross_metric",
    check_name: "Faculty Ratio Consistency",
    description: "Verifies that total enrollment divided by faculty count approximates the reported student-to-faculty ratio",
    severity: "info",
    target_metric_id: M.SF_RATIO,
    target_metric_name: MN[M.SF_RATIO],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "skipped",
    result_detail: "Skipped: The CDS student-to-faculty ratio (19.1:1) uses FTE-adjusted figures. Computing headcount-based ratio: 61,369 / 2,894 = 21.2:1, which is 2.1 higher than reported. The discrepancy is expected but cannot be precisely reconciled without part-time faculty FTE data.",
    run_at: "2024-09-05T11:15:00Z",
  },
  {
    id: "qc-005-20",
    check_type: "cross_metric",
    check_name: "Monotonic Check",
    description: "Checks that endowment values do not drop more than 30% year-over-year (market correction threshold)",
    severity: "critical",
    target_metric_id: M.ENDOWMENT,
    target_metric_name: MN[M.ENDOWMENT],
    target_entity_id: "inst-005",
    target_entity_name: "Ohio State",
    status: "skipped",
    result_detail: "Skipped: This check is categorized as cross_metric but is functionally a temporal check duplicating qc-005-10. Deduplication logic identified this as redundant. The temporal layer already confirmed endowment changes are within the -30% threshold.",
    run_at: "2024-09-05T11:15:00Z",
  },
];

// ===== REPORT 6: SUNY Buffalo 2023 — Score 88, 15 pass / 2 fail / 2 warning / 1 skipped =====

const checksQR006: QualityCheck[] = [
  // --- structural (4) ---
  {
    id: "qc-006-01",
    check_type: "structural",
    check_name: "Value Type Check",
    description: "Ensures each metric value matches its expected data type (numeric, percentage, currency, etc.)",
    severity: "info",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "All 14 submitted metric values for FY2023 conform to their declared types. Revenue values are numeric currency, enrollment metrics are integer counts, and percentage metrics fall within 0-100.",
    run_at: "2024-08-10T08:30:00Z",
  },
  {
    id: "qc-006-02",
    check_type: "structural",
    check_name: "Completeness Check",
    description: "Ensures all required dimensions (fiscal year, entity, peer group) are present for each observation",
    severity: "info",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "All required dimensions present for FY2023 observations. Entity, fiscal year, and peer group mappings are complete. Enrollment breakdowns (UG/Grad) are fully populated.",
    run_at: "2024-08-10T08:30:00Z",
  },
  {
    id: "qc-006-03",
    check_type: "structural",
    check_name: "Unit Consistency",
    description: "Ensures the unit of each observation matches the metric definition's declared unit",
    severity: "info",
    target_metric_id: M.RESEARCH_EXPENDITURE,
    target_metric_name: MN[M.RESEARCH_EXPENDITURE],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Research Expenditures reported in USD (currency) as defined in the glossary. All 14 metrics have consistent units matching their definitions for the FY2023 reporting period.",
    run_at: "2024-08-10T08:30:00Z",
  },
  {
    id: "qc-006-04",
    check_type: "structural",
    check_name: "Null Value Check",
    description: "Checks for missing or null values in required metric fields",
    severity: "critical",
    target_metric_id: M.AUXILIARY_MARGIN,
    target_metric_name: MN[M.AUXILIARY_MARGIN],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "No null or missing values detected across all 14 required metrics for SUNY Buffalo FY2023. Auxiliary Services Margin of 6.8% is present with a source reference to the FY2023 auxiliary enterprises report.",
    run_at: "2024-08-10T08:30:00Z",
  },
  // --- semantic (5) ---
  {
    id: "qc-006-05",
    check_type: "semantic",
    check_name: "Range Plausibility",
    description: "Checks if the metric value falls within a plausible range for this institution type and size",
    severity: "critical",
    target_metric_id: M.RETENTION_RATE,
    target_metric_name: MN[M.RETENTION_RATE],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "First-Year Retention Rate of 86.4% is within the expected range for AAU public research universities (80%-96%). Consistent with SUNY Buffalo's historical range of 85%-89%.",
    run_at: "2024-08-10T08:30:00Z",
  },
  {
    id: "qc-006-06",
    check_type: "semantic",
    check_name: "Business Rule: Revenue > Tuition",
    description: "Validates that total operating revenue exceeds net tuition revenue (a logical necessity)",
    severity: "critical",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Total Operating Revenue ($1.68B) exceeds Net Tuition Revenue ($398M) for FY2023. Tuition represents approximately 23.7% of total revenue, consistent with state-funded research university profile.",
    run_at: "2024-08-10T08:30:00Z",
  },
  {
    id: "qc-006-07",
    check_type: "semantic",
    check_name: "Percentage Bound",
    description: "Ensures percentage-type metrics fall within 0-100 range",
    severity: "critical",
    target_metric_id: M.GRAD_RATE_6YR,
    target_metric_name: MN[M.GRAD_RATE_6YR],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Six-Year Graduation Rate of 74.1% is within the valid 0-100 range. All four percentage-type metrics are within bounds for FY2023.",
    run_at: "2024-08-10T08:30:00Z",
  },
  {
    id: "qc-006-08",
    check_type: "semantic",
    check_name: "Non-Negative Value",
    description: "Ensures count and currency metrics are non-negative",
    severity: "warning",
    target_metric_id: M.ENDOWMENT,
    target_metric_name: MN[M.ENDOWMENT],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Endowment Market Value of $1.02B is positive and non-negative. All count and currency metrics for FY2023 are non-negative values.",
    run_at: "2024-08-10T08:30:00Z",
  },
  {
    id: "qc-006-09",
    check_type: "semantic",
    check_name: "Ratio Reasonableness",
    description: "Checks that student-to-faculty ratio falls within a reasonable range of 5:1 to 30:1",
    severity: "warning",
    target_metric_id: M.SF_RATIO,
    target_metric_name: MN[M.SF_RATIO],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Student-to-Faculty Ratio of 14.5:1 for FY2023 falls within the acceptable range of 5:1 to 30:1. Consistent with the FY2024 value of 14.2:1 and peer institution averages.",
    run_at: "2024-08-10T08:30:00Z",
  },
  // --- temporal (4) ---
  {
    id: "qc-006-10",
    check_type: "temporal",
    check_name: "Year-Over-Year Change",
    description: "Flags any metric with greater than 50% year-over-year change as potentially erroneous",
    severity: "warning",
    target_metric_id: M.ENDOWMENT,
    target_metric_name: MN[M.ENDOWMENT],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "warning",
    result_detail: "Endowment Market Value changed by +11.5% from FY2022 ($915M) to FY2023 ($1.02B). While within the 50% threshold, this is a notable recovery from the FY2022 market downturn. Flagging for informational purposes as it exceeds the 5-year average annual change of 6.2%.",
    expected_value: "Change within +/- 50%",
    actual_value: "+11.5% year-over-year",
    run_at: "2024-08-10T08:30:00Z",
  },
  {
    id: "qc-006-11",
    check_type: "temporal",
    check_name: "Trend Consistency",
    description: "Checks if the current value is consistent with the 5-year trend line for this metric",
    severity: "critical",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Total Fall Enrollment of 32,105 for FY2023 is consistent with the 5-year trend (31,210 -> 31,503 -> 31,789 -> 31,923 -> 32,105). The annualized growth rate of 0.6% is within the expected trend corridor.",
    run_at: "2024-08-10T08:30:00Z",
  },
  {
    id: "qc-006-12",
    check_type: "temporal",
    check_name: "Missing Year Check",
    description: "Verifies there are no gaps in the annual series for each metric",
    severity: "critical",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Total Operating Revenue has a complete annual series from FY2015 through FY2023 (9 years). No gaps detected. All values are sourced from audited financial statements.",
    run_at: "2024-08-10T08:30:00Z",
  },
  {
    id: "qc-006-13",
    check_type: "temporal",
    check_name: "Monotonic Check",
    description: "Checks that endowment values do not drop more than 30% year-over-year (market correction threshold)",
    severity: "critical",
    target_metric_id: M.ENDOWMENT,
    target_metric_name: MN[M.ENDOWMENT],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Endowment Market Value year-over-year changes are all within the -30% threshold for the FY2015-FY2023 series. Largest decline was -12.4% in FY2022, consistent with broad market conditions. FY2023 recovery to $1.02B.",
    run_at: "2024-08-10T08:30:00Z",
  },
  // --- cross_source (4) ---
  {
    id: "qc-006-14",
    check_type: "cross_source",
    check_name: "IPEDS vs Internal Match",
    description: "Compares enrollment figures from IPEDS with internally reported enrollment data",
    severity: "critical",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "fail",
    result_detail: "IPEDS-reported Total Fall Enrollment for FY2023 (32,105) differs from the internal enrollment census (32,892) by 787 students (2.5%). This exceeds the 1.0% tolerance threshold. Investigation reveals the internal system includes non-degree continuing education students not captured in the IPEDS fall census. Recommend establishing a standardized enrollment definition document.",
    expected_value: "Match within 1.0% tolerance",
    actual_value: "2.5% discrepancy (787 students)",
    run_at: "2024-08-10T08:30:00Z",
  },
  {
    id: "qc-006-15",
    check_type: "cross_source",
    check_name: "CDS vs IPEDS Enrollment",
    description: "Cross-references Common Data Set enrollment figures against IPEDS for consistency",
    severity: "warning",
    target_metric_id: M.ENROLLMENT_UG,
    target_metric_name: MN[M.ENROLLMENT_UG],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "warning",
    result_detail: "CDS undergraduate enrollment for FY2023 (21,405) differs from IPEDS undergraduate headcount (21,312) by 93 students (0.4%). While within the 1.0% tolerance, the discrepancy is larger than FY2022 (<0.1%). The CDS may include a small number of dual-enrollment high school students not counted in IPEDS.",
    expected_value: "Match within 1.0%",
    actual_value: "0.4% discrepancy (93 students)",
    run_at: "2024-08-10T08:30:00Z",
  },
  {
    id: "qc-006-16",
    check_type: "cross_source",
    check_name: "Multi-Source Revenue",
    description: "Checks that revenue figures are consistent across audited financials, IPEDS Finance, and internal reports",
    severity: "critical",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Total Operating Revenue from audited financials ($1.68B) aligns with IPEDS Finance ($1.67B) within 0.6% tolerance for FY2023. Internal budget reports ($1.68B) match audited statements. Cross-source consistency confirmed.",
    run_at: "2024-08-10T08:30:00Z",
  },
  {
    id: "qc-006-17",
    check_type: "cross_source",
    check_name: "Ranking Data Alignment",
    description: "Checks that US News data aligns with IPEDS data for key reported metrics",
    severity: "info",
    target_metric_id: M.RETENTION_RATE,
    target_metric_name: MN[M.RETENTION_RATE],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "US News reports a first-year retention rate of 86% for SUNY Buffalo for the FY2023 cycle, which matches the IPEDS value of 86.4% (US News rounds to nearest integer). Cross-source alignment confirmed.",
    run_at: "2024-08-10T08:30:00Z",
  },
  // --- cross_metric (3) ---
  {
    id: "qc-006-18",
    check_type: "cross_metric",
    check_name: "Enrollment Components Sum",
    description: "Validates that undergraduate + graduate enrollment equals total enrollment",
    severity: "critical",
    target_metric_id: M.ENROLLMENT_TOTAL,
    target_metric_name: MN[M.ENROLLMENT_TOTAL],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "fail",
    result_detail: "Undergraduate Enrollment (21,312) + Graduate Enrollment (10,651) = 31,963, but Total Fall Enrollment is reported as 32,105. The 142-student discrepancy (0.4%) suggests there are students categorized outside UG and Grad (possibly non-degree or auditing students) that are included in the total but not in either component. Recommend adding a 'non-degree' enrollment category to resolve the gap.",
    expected_value: "UG (21,312) + Grad (10,651) = Total (31,963)",
    actual_value: "Total reported as 32,105 (142 unaccounted)",
    run_at: "2024-08-10T08:30:00Z",
  },
  {
    id: "qc-006-19",
    check_type: "cross_metric",
    check_name: "Revenue vs Cost",
    description: "Checks that total revenue exceeds the product of cost per FTE and total FTE enrollment",
    severity: "info",
    target_metric_id: M.TOTAL_REVENUE,
    target_metric_name: MN[M.TOTAL_REVENUE],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "pass",
    result_detail: "Total Operating Revenue ($1.68B) exceeds estimated total cost for FY2023 (FTE enrollment 28,400 x estimated cost per FTE $46,100 = $1.31B). Revenue-to-cost ratio of 1.28 is within the expected range for a state-funded research university.",
    run_at: "2024-08-10T08:30:00Z",
  },
  {
    id: "qc-006-20",
    check_type: "cross_metric",
    check_name: "Faculty Ratio Consistency",
    description: "Verifies that total enrollment divided by faculty count approximates the reported student-to-faculty ratio",
    severity: "info",
    target_metric_id: M.SF_RATIO,
    target_metric_name: MN[M.SF_RATIO],
    target_entity_id: "inst-001",
    target_entity_name: "SUNY Buffalo",
    status: "skipped",
    result_detail: "Skipped: The CDS student-to-faculty ratio (14.5:1) uses FTE-adjusted figures. Headcount-based calculation yields 32,105 / 2,145 = 14.97:1, which is directionally consistent but cannot be precisely validated without FTE conversion factors for part-time faculty.",
    run_at: "2024-08-10T08:30:00Z",
  },
];

// ===== QUALITY REPORTS =====

export const qualityReports: QualityReport[] = [
  {
    id: "qr-001",
    entity_id: "inst-001",
    entity_name: "SUNY Buffalo",
    fiscal_year: 2024,
    run_at: "2024-08-15T09:00:00Z",
    total_checks: 20,
    passed: 16,
    failed: 1,
    warnings: 2,
    skipped: 1,
    overall_score: 92,
    checks: checksQR001,
  },
  {
    id: "qr-002",
    entity_id: "inst-002",
    entity_name: "UT Austin",
    fiscal_year: 2024,
    run_at: "2024-08-20T10:30:00Z",
    total_checks: 20,
    passed: 14,
    failed: 2,
    warnings: 3,
    skipped: 1,
    overall_score: 87,
    checks: checksQR002,
  },
  {
    id: "qr-003",
    entity_id: "inst-003",
    entity_name: "U of Michigan",
    fiscal_year: 2024,
    run_at: "2024-08-22T14:00:00Z",
    total_checks: 20,
    passed: 18,
    failed: 0,
    warnings: 1,
    skipped: 1,
    overall_score: 95,
    checks: checksQR003,
  },
  {
    id: "qr-004",
    entity_id: "inst-004",
    entity_name: "UC Berkeley",
    fiscal_year: 2024,
    run_at: "2024-09-01T08:00:00Z",
    total_checks: 20,
    passed: 11,
    failed: 4,
    warnings: 3,
    skipped: 2,
    overall_score: 78,
    checks: checksQR004,
  },
  {
    id: "qr-005",
    entity_id: "inst-005",
    entity_name: "Ohio State",
    fiscal_year: 2024,
    run_at: "2024-09-05T11:15:00Z",
    total_checks: 20,
    passed: 13,
    failed: 3,
    warnings: 2,
    skipped: 2,
    overall_score: 84,
    checks: checksQR005,
  },
  {
    id: "qr-006",
    entity_id: "inst-001",
    entity_name: "SUNY Buffalo",
    fiscal_year: 2023,
    run_at: "2024-08-10T08:30:00Z",
    total_checks: 20,
    passed: 15,
    failed: 2,
    warnings: 2,
    skipped: 1,
    overall_score: 88,
    checks: checksQR006,
  },
];

// ===== HELPER FUNCTIONS =====

/**
 * Returns all quality reports for a given entity (institution).
 * Supports looking up historical reports across multiple fiscal years.
 */
export const getQualityReportsByEntity = (entityId: string): QualityReport[] =>
  qualityReports.filter((r) => r.entity_id === entityId);

/**
 * Returns all quality checks of a given type across all reports.
 * Useful for analyzing patterns in a specific check category
 * (e.g., all "cross_source" checks to identify systemic data alignment issues).
 */
export const getQualityChecksByType = (type: string): QualityCheck[] =>
  qualityReports.flatMap((r) => r.checks).filter((c) => c.check_type === type);

/**
 * Returns all checks with a "fail" status across all reports.
 * Useful for surfacing the most critical data quality issues that need attention.
 */
export const getFailedChecks = (): QualityCheck[] =>
  qualityReports.flatMap((r) => r.checks).filter((c) => c.status === "fail");
